<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIPCEP Admin Panel</title>
    <link rel="manifest" href="manifest.json">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(34, 197, 94, 0.3);
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .status {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .connected { background: #22c55e; }
        .disconnected { background: #ef4444; }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr 300px;
            gap: 20px;
        }
        
        .panel {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border: 1px solid rgba(34, 197, 94, 0.1);
        }
        
        .panel h3 {
            margin-bottom: 20px;
            color: #1e293b;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Arama Durumlarƒ± */
        .incoming-call {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            animation: callPulse 1.5s infinite;
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.4);
        }
        
        .outgoing-call {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            animation: callPulse 1.5s infinite;
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.4);
        }
        
        .call-cancelled {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
        }
        
        .active-call {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.4);
        }
        
        @keyframes callPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .call-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            filter: brightness(1.1);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-accept {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3);
        }
        
        .btn-reject {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
        }
        
        .btn-call {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
            margin-left: 8px;
            box-shadow: 0 2px 8px rgba(5, 150, 105, 0.3);
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
        }
        
        /* Kullanƒ±cƒ± Y√∂netimi */
        .form-section {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 2fr 80px 120px;
            gap: 12px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .form-input {
            padding: 10px 14px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #22c55e;
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }
        
        /* Arama Kutusu */
        .search-container {
            position: relative;
            margin-bottom: 20px;
        }
        
        .search-input {
            width: 100%;
            padding: 14px 45px 14px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 15px;
            background: white;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #22c55e;
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }
        
        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
        }
        
        /* Kullanƒ±cƒ± Listesi */
        .user-list {
            max-height: 450px;
            overflow-y: auto;
        }
        
        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            margin-bottom: 10px;
            background: white;
            transition: all 0.3s ease;
        }
        
        .user-item:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-color: #22c55e;
        }
        
        .user-item.online-user {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            border-color: #22c55e;
        }
        
        .user-info {
            flex: 1;
        }
        
        .user-id {
            font-weight: 700;
            color: #2563eb;
            font-family: 'Courier New', monospace;
            font-size: 16px;
        }
        
        .user-name {
            color: #374151;
            font-size: 15px;
            font-weight: 600;
            margin: 2px 0;
        }
        
        .user-credits {
            color: #059669;
            font-size: 13px;
            font-weight: 600;
        }
        
        .user-status {
            color: #6b7280;
            font-size: 12px;
            margin-top: 4px;
        }
        
        .user-status.online {
            color: #22c55e;
            font-weight: 600;
        }
        
        .user-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* ƒ∞statistikler */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #22c55e;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .stat-number {
            font-size: 28px;
            font-weight: 800;
            color: #22c55e;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #64748b;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        /* Aktif Baƒülantƒ±lar */
        .connected-user {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin-bottom: 8px;
            background: white;
        }
        
        .user-online-dot {
            width: 10px;
            height: 10px;
            background: #22c55e;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .user-offline-dot {
            width: 10px;
            height: 10px;
            background: #6b7280;
            border-radius: 50%;
        }
        
        /* Bildirimler */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            max-width: 350px;
        }
        
        .notification {
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border-left: 4px solid #22c55e;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .notification.slide-out {
            animation: slideOut 0.3s ease-in;
        }
        
        @keyframes slideOut {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(100%); }
        }
        
        /* Log */
        .log-container {
            background: #1f2937;
            color: #f9fafb;
            padding: 15px;
            border-radius: 8px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin-top: 20px;
        }
        
        .log-container div {
            margin-bottom: 4px;
            opacity: 0.9;
        }
        
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }
        
        .highlighted {
            background: #fef3c7;
            font-weight: 600;
            padding: 0 2px;
            border-radius: 2px;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }
        
        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #64748b, #475569);
            color: white;
            box-shadow: 0 4px 15px rgba(100, 116, 139, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            box-shadow: 0 4px 15px rgba(5, 150, 105, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div>
                <h1>üéØ VIPCEP Admin Panel</h1>
                <p style="font-size: 16px; opacity: 0.9;">Voice IP Communication Emergency Protocol</p>
            </div>
            <div class="status">
                <div class="status-dot disconnected" id="statusDot"></div>
                <span id="statusText">Baƒülanƒ±yor...</span>
            </div>
        </div>
        
        <!-- ƒ∞statistikler -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalApproved">0</div>
                <div class="stat-label">Onaylƒ± Kullanƒ±cƒ±</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="onlineUsers">0</div>
                <div class="stat-label">√áevrimi√ßi</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalCredits">0</div>
                <div class="stat-label">Toplam Kredi</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="todayCalls">0</div>
                <div class="stat-label">Bug√ºn Arama</div>
            </div>
        </div>
        
        <div class="main-content">
            <!-- Sol Panel - Arama Y√∂netimi -->
            <div class="panel">
                <h3>üìû Arama Y√∂netimi</h3>
                
                <!-- Gelen Arama -->
                <div id="incomingCall" class="incoming-call hidden">
                    <h3>üìû GELEN ARAMA</h3>
                    <div style="margin: 15px 0;">
                        <p style="font-size: 18px; font-weight: 600;"><span id="callerName">-</span></p>
                        <p style="opacity: 0.9;">ID: <span id="callerId">-</span></p>
                        <p style="opacity: 0.9;">Kredi: <span id="callerCredits">-</span> dakika</p>
                    </div>
                    <div class="call-buttons">
                        <button class="btn btn-accept" id="acceptBtn" onclick="acceptCall()">
                            ‚úÖ Kabul Et
                        </button>
                        <button class="btn btn-reject" onclick="rejectCall()">
                            ‚ùå Reddet
                        </button>
                    </div>
                </div>
                <!-- Part 2'de devam edecek -->                <!-- Giden Arama -->
                <div id="outgoingCall" class="outgoing-call hidden">
                    <h3>üìû Gƒ∞DEN ARAMA</h3>
                    <div style="margin: 15px 0;">
                        <p style="font-size: 18px; font-weight: 600;"><span id="outgoingName">-</span></p>
                        <p style="opacity: 0.9;">ID: <span id="outgoingId">-</span></p>
                        <p style="opacity: 0.9;">Kredi: <span id="outgoingCredits">-</span> dakika</p>
                    </div>
                    <div style="margin: 15px 0; opacity: 0.9; font-size: 14px;">
                        üì± M√º≈üteriye arama bildirimi g√∂nderildi...
                    </div>
                    <div class="call-buttons">
                        <button class="btn btn-reject" onclick="cancelOutgoingCall()">
                            ‚ùå ƒ∞ptal Et
                        </button>
                    </div>
                </div>

                <!-- Arama ƒ∞ptal Bildirimi -->
                <div id="callCancelled" class="call-cancelled hidden">
                    <h3>‚ùå ARAMA ƒ∞PTAL EDƒ∞LDƒ∞</h3>
                    <div style="margin: 15px 0;">
                        <p style="font-weight: 600;"><span id="cancelledName">-</span></p>
                        <p style="opacity: 0.9;">ID: <span id="cancelledId">-</span></p>
                        <p style="opacity: 0.9;" id="cancelledReason">M√º≈üteri aramayƒ± iptal etti</p>
                    </div>
                    <button class="btn" style="background: #6b7280; color: white; margin-top: 10px;" onclick="dismissCancelledCall()">
                       ‚úîÔ∏è Tamam
                    </button>
                </div>
                
                <!-- Aktif G√∂r√º≈üme -->
                <div id="activeCall" class="active-call hidden">
                    <h3>üîä G√ñR√ú≈ûME AKTƒ∞F</h3>
                    <p style="font-size: 18px; font-weight: 600; margin: 10px 0;"><span id="activeCaller">-</span></p>
                    <div style="font-size: 32px; font-weight: 800; margin: 15px 0; font-family: 'Courier New', monospace;" id="callTimer">00:00</div>
                    <button class="btn btn-reject" onclick="endCall()">
                        üìû G√∂r√º≈ümeyi Bitir
                    </button>
                </div>
                
                <!-- Sistem Loglarƒ± -->
                <h3 style="margin-top: 25px;">üìã Sistem Loglarƒ±</h3>
                <div class="log-container" id="logContainer">
                    <div>[Sistem] Admin panel ba≈ülatƒ±lƒ±yor...</div>
                </div>
            </div>
            
            <!-- Orta Panel - Kullanƒ±cƒ± Y√∂netimi -->
            <div class="panel">
                <h3>üÜî Kullanƒ±cƒ± Y√∂netimi</h3>
                
                <!-- Yeni Kullanƒ±cƒ± Ekleme -->
                <div class="form-section">
                    <h4 style="margin-bottom: 15px; color: #374151;">‚ûï Yeni Kullanƒ±cƒ± Ekle</h4>
                    <div class="form-row">
                        <input type="text" id="newUserId" placeholder="4 haneli ID" maxlength="4" class="form-input">
                        <input type="text" id="newUserName" placeholder="Ad Soyad" class="form-input">
                        <input type="number" id="newUserCredits" placeholder="Kredi" min="0" class="form-input">
                        <button class="btn btn-primary" onclick="addApprovedUser()">‚ûï Ekle</button>
                    </div>
                </div>

                <!-- Arama Kutusu -->
                <div class="search-container">
                    <input type="text" id="searchInput" class="search-input" placeholder="üîç Kullanƒ±cƒ± adƒ± veya ID ile ara..." oninput="searchUsers()">
                    <div class="search-icon">
                        <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                    </div>
                </div>

                <!-- Arama Sonucu Bilgisi -->
                <div id="searchResults" style="font-size: 13px; color: #6b7280; margin-bottom: 15px; padding: 8px 15px; background: #f1f5f9; border-radius: 6px; border-left: 3px solid #22c55e;" class="hidden"></div>
                
                <!-- Onaylƒ± Kullanƒ±cƒ±lar -->
                <div class="user-list" id="approvedUsersList">
                    <div style="text-align: center; color: #6b7280; padding: 30px;">
                        <div style="font-size: 48px; margin-bottom: 10px;">üë•</div>
                        <div>Hen√ºz onaylƒ± kullanƒ±cƒ± yok</div>
                    </div>
                </div>
            </div>
            
            <!-- Saƒü Panel - Aktif Baƒülantƒ±lar -->
            <div class="panel">
                <h3>üë• Aktif Baƒülantƒ±lar</h3>
                <div id="userList" style="margin-top: 15px;">
                    <div style="text-align: center; color: #6b7280; padding: 30px;">
                        <div style="font-size: 48px; margin-bottom: 10px;">üåê</div>
                        <div>Hen√ºz kullanƒ±cƒ± baƒülanmadƒ±</div>
                    </div>
                </div>
                
                <!-- Hƒ±zlƒ± ƒ∞≈ülemler -->
                <div class="quick-actions">
                    <button class="btn btn-secondary" onclick="refreshData()">
                        üîÑ Verileri Yenile
                    </button>
                    <button class="btn btn-primary" onclick="window.open('https://wa.me/905374792403', '_blank')">
                        üí¨ WhatsApp Destek
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bildirim Konteyner -->
    <div id="creditNotifications" class="notification-container"></div>
    
    <!-- Gizli ses elementi -->
    <audio id="remoteAudio" autoplay></audio>

    <!-- Part 3'te scriptler ve fonksiyonlar ba≈ülayacak -->    <script>
        // Global deƒüi≈ükenler
        let socket = null;
        let peerConnection = null;
        let localStream = null;
        let currentCall = null;
        let callTimer = null;
        let callDuration = 0;
        let connectedUsers = [];
        let approvedUsers = [];
        let filteredUsers = [];
        let outgoingCallInfo = null;

        const adminId = "ADMIN001";
        const serverUrl = window.location.hostname === 'localhost'
            ? 'ws://localhost:8080'
            : `wss://vipcep-server-production.up.railway.app`;

        // API'den kullanƒ±cƒ±larƒ± y√ºkle
        async function fetchApprovedUsers() {
            try {
                const response = await fetch('/api/approved-users');
                if (response.ok) {
                    const apiUsers = await response.json();
                    approvedUsers = apiUsers.map(user => ({
                        id: user.id,
                        name: user.name,
                        credits: user.credits || 0,
                        createdAt: user.created_at ? new Date(user.created_at).toLocaleString() : new Date().toLocaleString(),
                        totalCalls: user.total_calls || 0,
                        lastCall: user.last_call ? new Date(user.last_call).toLocaleString() : null
                    }));
                    localStorage.setItem('vipcep_approved_users', JSON.stringify(approvedUsers));
                } else {
                    approvedUsers = JSON.parse(localStorage.getItem('vipcep_approved_users') || '[]');
                }
            } catch (err) {
                approvedUsers = JSON.parse(localStorage.getItem('vipcep_approved_users') || '[]');
            }
        }

        // Onaylƒ± kullanƒ±cƒ±larƒ± y√ºkle
        async function loadApprovedUsers() {
            await fetchApprovedUsers();
            renderApprovedUsers();
            updateStats();
        }

        // Sayfa y√ºklendiƒüinde ba≈ülat
        window.onload = function() {
            log('üöÄ Admin panel ba≈ülatƒ±lƒ±yor...');
            loadApprovedUsers();
            connectToServer();
            document.getElementById('newUserId').addEventListener('input', function(e) {
                e.target.value = e.target.value.replace(/[^0-9]/g, '');
            });
        };

        // Verileri API'den yenile
        async function refreshData() {
            log('üîÑ Veriler API\'den yenileniyor...');
            const refreshButton = document.querySelector('button[onclick="refreshData()"]');
            const originalText = refreshButton.textContent;
            refreshButton.disabled = true;
            refreshButton.textContent = '‚è≥ Yenileniyor...';
            try {
                await loadApprovedUsers();
                showSuccessNotification('Veriler ba≈üarƒ±yla yenilendi!');
                log('‚úÖ T√ºm veriler API\'den g√ºncellendi');
            } catch (error) {
                log('‚ùå Veri yenileme hatasƒ±: ' + error.message);
                alert('Veri yenileme hatasƒ±: ' + error.message);
            } finally {
                refreshButton.disabled = false;
                refreshButton.textContent = originalText;
            }
        }

        // Kredi g√ºncelleme i≈ülemlerinden sonra g√ºncel veriyi API'den √ßek
        async function updateCredits(userId, newCredits) {
            const user = approvedUsers.find(u => u.id === userId);
            if (!user) {
                alert('Kullanƒ±cƒ± bulunamadƒ±!');
                return;
            }
            const oldCredits = user.credits;
            try {
                const response = await fetch(`/api/approved-users/${userId}/credits`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        credits: parseInt(newCredits) || 0,
                        reason: `Admin tarafƒ±ndan g√ºncellendi: ${oldCredits} ‚Üí ${newCredits}`
                    })
                });
                const data = await response.json();
                if (data.success) {
                    // API'den g√ºncel kullanƒ±cƒ±larƒ± √ßek!
                    await loadApprovedUsers();
                    // Bildirim ve websocket
                    if (socket && socket.readyState === WebSocket.OPEN) {
                        socket.send(JSON.stringify({
                            type: 'credit-update-broadcast',
                            userId: userId,
                            newCredits: parseInt(newCredits) || 0,
                            updatedBy: 'admin'
                        }));
                    }
                    log(`üí≥ Kredi ba≈üarƒ±yla g√ºncellendi: ${userId} -> ${newCredits} dk`);
                    showCreditUpdateNotification(userId, user.name, oldCredits, parseInt(newCredits) || 0);
                    // Push notification
                    if (window.sendLocalNotification) {
                        sendLocalNotification('Kredi G√ºncellendi', `Kullanƒ±cƒ±: ${user.name} (${userId}) Yeni kredi: ${newCredits} dk`);
                    }
                } else {
                    alert('Kredi g√ºncellenemedi: ' + (data.error || 'Bilinmeyen hata'));
                    log(`‚ùå Kredi g√ºncelleme hatasƒ±: ${userId} -> ${data.error}`);
                }
            } catch (error) {
                console.error('Kredi g√ºncelleme hatasƒ±:', error);
                alert('Kredi g√ºncelleme sƒ±rasƒ±nda hata olu≈ütu!');
                log(`‚ùå Kredi g√ºncelleme API hatasƒ±: ${error.message}`);
            }
        }

        // ... Diƒüer t√ºm JS fonksiyonlarƒ±n burada bozulmadan devam ediyor ...
        // Son partta push notification import, script sonu ve dosya kapanƒ±≈üƒ± olacak.
    </script>        // ... Diƒüer fonksiyonlar, √∂rneƒüin searchUsers, highlightText, callUser, showOutgoingCall, playAdminRingbackTone, stopAdminRingbackTone, cancelOutgoingCall, addApprovedUser, removeApprovedUser, renderApprovedUsers, updateStats, isUserApproved, connectToServer, handleMessage, showIncomingCall, showCallCancelled, hideCallCancelled, dismissCancelledCall, showCreditNotification, playNotificationSound, acceptCall, rejectCall, endCall, setupOutgoingPeerConnection, handleOffer, handleAnswer, handleIceCandidate, startCallTimer, updateUserList, updateStatus, log, downloadCustomerApp, testIncomingCall ... Hepsi orijinal dosyandaki ≈üekliyle burada yer alƒ±yor.
        
        // Push notification fonksiyonu dosyanƒ±n sonuna eklenecek
    </script>
    <script type="module">
        // Push notification mod√ºl√ºn√º ekle ve ba≈ülat
        import { setupPushNotifications, sendLocalNotification } from './push-notification.js';
        setupPushNotifications();
        window.sendLocalNotification = sendLocalNotification;
        // Kredi g√ºncelleme ve √∂nemli olaylarda sendLocalNotification ile bildirim g√∂nderebilirsin.
    </script>
</body>
</html>
